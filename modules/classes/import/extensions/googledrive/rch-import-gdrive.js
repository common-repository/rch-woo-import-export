"use strict";var pickerOauthToken,pickerDeveloperKey="",pickerClientId="",pickerScope=["https://www.googleapis.com/auth/drive.readonly"],pickerApiLoaded=!1;function rchLoadPicker(){gapi.load("auth",{callback:rchOnAuthApiLoad}),gapi.load("picker",{callback:rchOnPickerApiLoad})}function rchOnAuthApiLoad(){window.gapi.auth.authorize({client_id:pickerClientId,scope:pickerScope,immediate:!1},rchHandleAuthResult)}function rchOnPickerApiLoad(){pickerApiLoaded=!0,rchCreatePicker()}function rchHandleAuthResult(e){e&&!e.error&&(pickerOauthToken=e.access_token,rchCreatePicker())}function rchCreatePicker(){pickerApiLoaded&&pickerOauthToken&&(new google.picker.PickerBuilder).addViewGroup(new google.picker.ViewGroup(google.picker.ViewId.DOCS).addView(google.picker.ViewId.DOCUMENTS).addView(google.picker.ViewId.PRESENTATIONS)).setOAuthToken(pickerOauthToken).setDeveloperKey(pickerDeveloperKey).setCallback(rchPickerCallback).build().setVisible(!0)}function rchPickerCallback(e){if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){rchSetProcessLoader({rchDownloadFileText:rchPluginSettings.rchLocalizeText.rchDownloadFileText});var i=e[google.picker.Response.DOCUMENTS][0];jQuery.ajax({url:rchPluginSettings.rchAjaxURL,type:"POST",data:"action=rch_import_upload_file_from_googledrive&rch_import_id="+rchPluginSettings.rchImportId+"&fileId="+i.id+"&oAuthToken="+pickerOauthToken+"&name="+i.name,dataType:"json",async:!0,success:function(e){if(rchUpdateProcessLoader("rchDownloadFileText"),"error"==e.status)return rchSetErrorMsg(e.message),!1;rchSetFileData(e)},error:function(e,i){rchHandleAjaxError(e,i)}})}}jQuery(document).on("click",".rch_google_drive_upload_btn",function(){pickerDeveloperKey=jQuery(".rch_gd_developer_key").val(),""!=(pickerClientId=jQuery(".rch_gd_client_id").val())&&rchLoadPicker()});