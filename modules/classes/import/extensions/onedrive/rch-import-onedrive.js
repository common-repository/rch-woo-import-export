"use strict";function rchUploadOnedriveFile(e){rchSetProcessLoader({rchDownloadFileText:rchPluginSettings.rchLocalizeText.rchDownloadFileText});var i=e.value[0],r=i["@microsoft.graph.downloadUrl"],n=i.name;jQuery.ajax({url:rchPluginSettings.rchAjaxURL,type:"POST",data:"action=rch_import_upload_file_from_onedrive&rch_import_id="+rchPluginSettings.rchImportId+"&file_url="+r+"&fileName="+n,dataType:"json",async:!0,success:function(e){if(rchUpdateProcessLoader("rchDownloadFileText"),"error"==e.status)return rchSetErrorMsg(e.message),!1;rchSetFileData(e)},error:function(e,i){rchHandleAjaxError(e,i)}})}jQuery(document).on("click",".rch_onedrive_upload_btn",function(){var e=jQuery(".rch_onedrive_client_id").val();if(""!=e){var i={clientId:e,action:"download",multiSelect:!1,advanced:{redirectUri:jQuery(".rch_onedrive_redirect_uri").val()},openInNewWindow:!0,success:function(e){rchUploadOnedriveFile(e)},cancel:function(){},error:function(e){}};OneDrive.open(i)}});